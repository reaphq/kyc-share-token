# Example Files

This directory contains example CSV files to help you get started with the KYC Share Token Generator.

## Files

### sample_input.csv

This is an example input file showing the required CSV format for the tool.

**Format**:
- `applicantId`: Sumsub applicant identifier (24-character hexadecimal)
- `externalId`: Your unique entity identifier (UUID format)
- `applicantLevel`: Sumsub verification level (optional - can be empty to use default)

**Usage**:
```bash
python sumsub_share_token_generator.py examples/sample_input.csv examples/my_output.csv
```

### sample_output.csv

This is an example output file showing what the tool generates.

**Output Columns**:
- `externalId`: Original external ID
- `shareToken`: JWT share token generated by Sumsub (or `DRY_RUN`/`FAILED`)
- `error`: Error message if token generation failed (empty if successful)

## Creating Your Own Input File

### Using a Spreadsheet Application

1. Open Excel, Google Sheets, or Numbers
2. Create three columns with headers: `applicantId`, `externalId`, `applicantLevel`
3. Fill in your data:
   - **applicantId**: Copy from your Sumsub dashboard or API
   - **externalId**: UUID from your entity database
   - **applicantLevel** (optional): Match the level used when creating the applicant in Sumsub, or omit entirely to use default
4. Export as CSV (UTF-8 encoding)

### Using Python/Pandas

```python
import pandas as pd
import uuid

# Create sample data
data = {
    'applicantId': ['68c276d1827b5c7a72ec620e', '68c276d1827b5c7a72ec620f'],
    'externalId': [str(uuid.uuid4()), str(uuid.uuid4())],
    'applicantLevel': ['levelKyc', 'levelKyc']
}

# Create DataFrame and save
df = pd.DataFrame(data)
df.to_csv('my_input.csv', index=False)
```

### Using Command Line

```bash
# Create CSV file
cat > my_input.csv << EOF
applicantId,externalId,applicantLevel
68c276d1827b5c7a72ec620e,ef88fd57-26cf-415d-a112-941732c55350,levelKyc
68c276d1827b5c7a72ec620f,b1234567-89ab-cdef-0123-456789abcdef,levelKyc
EOF
```

## Validation Checklist

Before running the tool, verify your input CSV:

- [ ] File has header row with exact column names (case-sensitive)
- [ ] `applicantId` values are valid Sumsub applicant IDs (24-char hex strings)
- [ ] `externalId` values are valid UUIDs
- [ ] `applicantLevel` is optional (can be completely omitted or left empty for default level)
- [ ] No empty rows or missing required values
- [ ] File is UTF-8 encoded
- [ ] File size is under 10 MB
- [ ] Row count is under 5,000 (for batch upload compatibility)

## Common Issues

### Issue: "Missing required column"

**Cause**: Column headers don't match exactly (case-sensitive)

**Solution**: Ensure headers are exactly: `applicantId`, `externalId`, `applicantLevel`

### Issue: "Invalid applicant ID format"

**Cause**: applicantId is not in the correct format

**Solution**: Verify applicant IDs are 24-character hexadecimal strings from Sumsub

### Issue: "File contains BOM characters"

**Cause**: File was saved with UTF-8 BOM encoding

**Solution**: Re-save as plain UTF-8 (without BOM):
- Excel: Save As > CSV UTF-8 (Comma delimited) (.csv)
- Numbers: Export > CSV > Advanced Options > Text Encoding: UTF-8
- TextEdit: Format > Make Plain Text, then save

## Testing Your Input File

Use dry-run mode to validate your file without making API calls:

```bash
python sumsub_share_token_generator.py --dry-run my_input.csv my_output.csv
```

This will validate the CSV format and report any issues without generating actual tokens.

## Sample Data Generators

### Generate Test Data

If you need test data for development:

```python
import pandas as pd
import uuid

def generate_test_csv(num_records, output_file):
    """Generate test CSV with fake data."""
    data = {
        'applicantId': [f'68c276d1827b5c7a72ec6{i:03d}' for i in range(num_records)],
        'externalId': [str(uuid.uuid4()) for _ in range(num_records)],
        'applicantLevel': ['levelKyc'] * num_records
    }
    df = pd.DataFrame(data)
    df.to_csv(output_file, index=False)
    print(f"Generated {num_records} test records in {output_file}")

# Generate 100 test records
generate_test_csv(100, 'test_input.csv')
```

## Integration with Reap API

After generating share tokens, the output CSV can be directly uploaded to the Reap KYC Batch Upload API:

```bash
curl -X POST https://api.reap.global/entity/kyc/import/batch \
  -H "Authorization: COMPLIANCE_API_KEY" \
  -H "X-Provider: sumsub" \
  -H "Idempotency-Key: batch-$(date +%s)-$(uuidgen)" \
  -F "file=@examples/sample_output.csv"
```

See [../docs/INTEGRATION.md](../docs/INTEGRATION.md) for complete integration instructions.

---

For more information, see the main [README](../README.md).
